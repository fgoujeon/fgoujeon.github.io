<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Maki: The Undefined State</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Maki
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('undefined-state.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">The Undefined State </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md__2home_2florian_2Development_2maki_2src_2doc_2extra_2undefined-state"></a></p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md60"></a>
Definition</h1>
<p>The <b>undefined state</b> is a predefined state that is active during external transitions. This is a safety feature that is not part of the UML specification.</p>
<p>The undefined state is activated right before the execution of the transition and deactivated (for the benefit of the target state) right after the execution of the transition.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md61"></a>
Why We Need the Undefined State</h1>
<p>Executing an external transition mainly consists of:</p><ol type="1">
<li>executing the exit action of the source state;</li>
<li>executing the transition action;</li>
<li>executing the entry action of the target state.</li>
</ol>
<p>Also, at some point, the target state must be activated (i.e. marked as the active state of the region).</p>
<p>Problem: any of these steps can throw an exception, and there's no obvious choice for the resulting active state in case of exception.</p><ul>
<li>We can't reasonably keep the source state active. What if we already invoked its exit action? We don't want to risk using deallocated resources from an internal action, or deallocate resources twice, or even try to invoke that exit action again if it's the one that threw.</li>
<li>We can't reasonably activate the target state either. What if it has an entry action that we couldn't successfully execute? We don't want to risk using or releasing non-allocated resources from an internal action or an exit action. Even in the absence of an entry action, we don't want to go against the behavior defined in the transition table by activating a state without properly executing the action of the transition that leads to it.</li>
</ul>
<p>This is why Maki has made the choice of a third outcome: the activation of another state that doesn't have an entry action (so that its activation can't throw another exception).</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md62"></a>
How to Use the Undefined State with Maki</h1>
<p>Maki defines these two objects:</p><ul>
<li><span class="tt"><a class="el" href="namespacemaki.html#ae8bf139fa9ac4bf5ff6ebc03ad0f478a" title="The state mold of the undefined state.">maki::undefined</a></span>, the state mold of the undefined state, to be given to transition tables;</li>
<li><span class="tt"><a class="el" href="namespacemaki_1_1states.html#a8aa1b93b631253773ea5c00d2ad8879f" title="Represents the undefined state.">maki::states::undefined</a></span>, the state object created by <span class="tt"><a class="el" href="namespacemaki.html#ae8bf139fa9ac4bf5ff6ebc03ad0f478a" title="The state mold of the undefined state.">maki::undefined</a></span>, given to transition hooks.</li>
</ul>
<p>To take advantage of the undefined state, you should define, in every topmost region, a transition whose:</p><ul>
<li>source state is either <span class="tt"><a class="el" href="namespacemaki.html#ae8bf139fa9ac4bf5ff6ebc03ad0f478a" title="The state mold of the undefined state.">maki::undefined</a></span> or any open-ended <a class="el" href="state-set.html">state sets</a> that contains <span class="tt"><a class="el" href="namespacemaki.html#ae8bf139fa9ac4bf5ff6ebc03ad0f478a" title="The state mold of the undefined state.">maki::undefined</a></span> (such as <span class="tt">maki::all_states</span>);</li>
<li>trigger is some kind of error event that you'd emit from a <a class="el" href="catch-action.html">catch action</a>;</li>
<li>target is some kind of error state.</li>
</ul>
<p>Such a setup would look like this:</p>
<div class="plantumlgraph">
<img src="exception_recovery.png" />
<div class="caption">
A typical setup for exception recovery</div>
</div>
<dl class="section note"><dt>Note</dt><dd>While it can be relevant, you don't necessarily have to define transitions from the undefined state in composite states. The guarantees provided by the undefined state allow you to exit any active composite state without having to worry about executing an irrelevant exit action. </dd></dl>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="index.html">Maki</a></li><li class="navelem"><a href="extra.html">Extra Features</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
